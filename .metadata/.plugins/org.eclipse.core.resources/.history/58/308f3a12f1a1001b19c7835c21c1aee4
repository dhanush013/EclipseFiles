package com.cts.pdms.dao;

import java.sql.Connection;
import java.sql.DriverManager;

//package com.cts.pdms.dao;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.sql.SQLException;
import java.util.Properties;

import com.cts.pdms.exception.PostalDeptMgmtException;

public class DBConnectionManager 
{
	private static Connection con = null;
	 private  String Dname=null;
	 private  String url=null;
	 private  String username=null;
	 private  String password=null;
	 private static DBConnectionManager instance=null;
	 
	 public  DBConnectionManager()  throws PostalDeptMgmtException
	  {
		try 
		{
			FileInputStream fis=new FileInputStream("C:\\Users\\Jiban Barman\\Desktop\\Testing\\PostalDeptMgmtSystm\\Resources\\database.properties");
			Properties p=new Properties();
			p.load(fis);
			Dname=(String)p.get("drivername");
			url=(String)p.get("url");
			username=(String)p.get("username");
			password=(String)p.get("password");
			Class.forName(Dname);
			con=DriverManager.getConnection(url,username,password);
		//	System.out.println("Database Connected");
		} 
		
		catch (FileNotFoundException e) 
		{
			throw new PostalDeptMgmtException();
		} 
		catch (IOException e) 
		{
			throw new PostalDeptMgmtException();
		} 
		catch (SQLException e)
		{
			
			throw new PostalDeptMgmtException();
		} 
		catch (ClassNotFoundException e) 
		{
			throw new PostalDeptMgmtException();
		}
		 
		// TYPE YOUR CODE HERE
		
       //return con;
	}
	 
	public static DBConnectionManager getInstance() throws PostalDeptMgmtException,SQLException 
	{
		if(instance==null) 
		{
			instance=new DBConnectionManager();
		}
		else if(instance.getConnection().isClosed())
		{
			instance=new DBConnectionManager();
		}
		return instance;
	}
	
	public Connection getConnection() 
	{
		return con;
	}
//public static void main(String[] args) throws PostalDeptMgmtException, SQLException {
//	DBConnectionManager.getInstance().getConnection();
//}
}