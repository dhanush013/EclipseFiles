package com.cts.emp.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.List;
import com.cts.emp.dto.Employee;
import com.cts.emp.exception.EmployeeSystemAdminException;
import com.cts.emp.util.ApplicationUtil;
import com.cts.emp.util.DBConnectionManager;

public class EmployeeDAO {

	public static Connection connection = null;

	public boolean addEmployeeDetails(List<Employee> employeeList) throws EmployeeSystemAdminException {
		boolean recordsAdded = false;
		try {
			DBConnectionManager dbConMg = DBConnectionManager.getInstance();
			connection = dbConMg.getConnection();
		
			for(Employee empObj:employeeList) {
				PreparedStatement prepState = connection.prepareStatement(DbConstants.INSERT_EMP_COMMAND);
				prepState.setInt(0, empObj.getEmpno());
				prepState.setString(1, empObj.getEmpname());
				prepState.setString(2, empObj.getDesig());
				prepState.setString(3, empObj.getEmptype());
				prepState.setDouble(4, empObj.getSalary());
				prepState.setDate(5, ApplicationUtil.utilToSqlDateConverter(empObj.getDob()));
				prepState.execute();
				recordsAdded = true;
			}
		} catch(SQLException e) {
			throw new EmployeeSystemAdminException(e.getMessage());
		}
		return recordsAdded;
	}

}
